# –ù–∞—Ä–∫–æ–∫–∞—Ä—Ç–∞

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ç–æ—á–µ–∫ —Å API, –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ Telegram –±–æ—Ç–æ–º.

## üöÄ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. üîß API Backend (FastAPI)
–ü–æ—Ä—Ç–∏—Ä—É–µ–º—ã–π REST API —Å –ø–æ–ª–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π

### 2. üåê –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å –º–µ—Ç–∫–∞–º–∏ –Ω–∞ –±–∞–∑–µ Leaflet

### 3. ü§ñ Telegram –ë–æ—Ç
–£–¥–æ–±–Ω—ã–π –±–æ—Ç —Å –∫–Ω–æ–ø–∫–æ–π "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–º"

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: OTP –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ + JWT —Ç–æ–∫–µ–Ω—ã
- **–ú–µ—Ç–∫–∏**: –°–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ—Å–º–æ—Ç—Ä, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–æ–∫ –Ω–∞ –∫–∞—Ä—Ç–µ —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π
- **–ú–æ–¥–µ—Ä–∞—Ü–∏—è**: –°–∏—Å—Ç–µ–º–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –º–µ—Ç–æ–∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º–∏
- **–ü–æ–ª–∏—Ü–∏—è**: –û—Ç–º–µ—Ç–∫–∞ –º–µ—Ç–æ–∫ –∫–∞–∫ "—Ä–µ—à–µ–Ω–æ" —Å –æ—Ç—á—ë—Ç–∞–º–∏ –∏ —Ñ–æ—Ç–æ
- **RBAC**: –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å (user, moderator, police, admin)
- **–ü–æ—Ä—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –í–µ–±, Telegram, –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –¥–µ—Å–∫—Ç–æ–ø
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ì–æ—Ç–æ–≤ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ PostgreSQL, Redis, S3

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Backend**: Python 3.11, FastAPI
- **Database**: SQLite (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞) / PostgreSQL (–ø—Ä–æ–¥–∞–∫—à–µ–Ω)
- **Auth**: JWT, OTP —á–µ—Ä–µ–∑ SMS
- **Web**: HTML5, CSS3, Leaflet, Vanilla JS
- **Bot**: python-telegram-bot
- **Testing**: pytest
- **Deployment**: Docker, docker-compose

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <repo-url>
cd narcomap

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π
python scripts/generate_keys.py

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ .env.example –≤ .env –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env, –¥–æ–±–∞–≤—å—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JWT_SECRET_KEY

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
python scripts/init_db.py

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
uvicorn app.main:app --reload

# API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:8000
# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs
```

### Docker –∑–∞–ø—É—Å–∫

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up --build

# –í —Ñ–æ–Ω–µ
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

### üåê –ó–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É web
cd web

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ HTTP —Å–µ—Ä–≤–µ—Ä (Python)
python -m http.server 8080

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Node.js
npm install -g http-server
http-server -p 8080

# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
open http://localhost:8080
```

–°–º. [web/README.md](web/README.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

### ü§ñ –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install python-telegram-bot httpx

# –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
export TELEGRAM_BOT_TOKEN="your-bot-token-here"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
python telegram_bot.py
```

–°–º. [TELEGRAM_BOT.md](TELEGRAM_BOT.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

## üì± –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8080 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"
3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Üí –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–¥
4. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É ‚Üí —Å–æ–∑–¥–∞–π—Ç–µ –º–µ—Ç–∫—É

### –í–∞—Ä–∏–∞–Ω—Ç 2: Telegram –±–æ—Ç

1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ù–∞–∂–º–∏—Ç–µ "üîë –í–æ–π—Ç–∏" ‚Üí –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –∫–æ–Ω—Ç–∞–∫—Ç–æ–º
4. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ ‚Üí –≥–æ—Ç–æ–≤–æ!
5. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é ‚Üí —Å–æ–∑–¥–∞–π—Ç–µ –º–µ—Ç–∫—É
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
narcomap/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                      # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ config.py                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ database.py                  # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ models.py                    # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ auth/                        # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (JWT, OTP, RBAC)
‚îÇ   ‚îú‚îÄ‚îÄ services/                    # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ routers/                     # API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ adapters/                    # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (SMS, Telegram, Push, Webhooks)
‚îÇ   ‚îî‚îÄ‚îÄ utils/                       # –í–∞–ª–∏–¥–∞—Ü–∏—è, rate limiting
‚îú‚îÄ‚îÄ tests/                           # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ scripts/                         # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ uploads/                         # –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã
‚îî‚îÄ‚îÄ logs/                           # –õ–æ–≥–∏ (–≤–∫–ª—é—á–∞—è OTP –∫–æ–¥—ã)
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env` —Ñ–∞–π–ª–µ.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```bash
# Database
DATABASE_URL=sqlite:///./narcomap.db  # –ò–ª–∏ postgresql://...

# JWT
JWT_SECRET_KEY=<generated-secret>     # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ generate_keys.py
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# OTP
OTP_EXPIRE_MINUTES=5
OTP_LENGTH=6
OTP_LOG_FILE=./logs/otp.log          # –í–ê–ñ–ù–û: –õ–æ–≥–∏ OTP –∫–æ–¥–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!)

# SMS Provider
SMS_PROVIDER=mock                     # mock | twilio | smsru | custom
# SMS_API_KEY=your-key                # –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
# SMS_API_URL=https://...             # –î–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

# Rate Limiting
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# Media
UPLOAD_DIR=./uploads
MAX_UPLOAD_SIZE_MB=10
USE_S3=False                          # True –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
```

–°–º. `.env.example` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

## –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### –ü—Ä–æ—Ü–µ—Å—Å OTP + JWT

1. **–ó–∞–ø—Ä–æ—Å OTP –∫–æ–¥–∞**

```bash
curl -X POST http://localhost:8000/auth/request-otp \
  -H "Content-Type: application/json" \
  -d '{"phone": "+79991234567"}'

# Response: {"success": true, "message": "OTP –∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω", "code": "123456"}
# –ö–æ–¥ —Ç–∞–∫–∂–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ logs/otp.log
```

2. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è OTP**

```bash
curl -X POST http://localhost:8000/auth/verify-otp \
  -H "Content-Type: application/json" \
  -d '{"phone": "+79991234567", "code": "123456"}'

# Response: {
#   "access_token": "eyJhbGci...",
#   "refresh_token": "eyJhbGci...",
#   "user_id": 1,
#   "role": "user"
# }
```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞**

```bash
curl http://localhost:8000/users/me \
  -H "Authorization: Bearer eyJhbGci..."
```

### OTP –∫–æ–¥—ã –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

–í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (SQLite) OTP –∫–æ–¥—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `logs/otp.log` –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```
2025-10-30 10:00:00 - OTP for +79991234567: 123456
```

**–í–ê–ñ–ù–û**: –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ OTP –∫–æ–¥–æ–≤!

## API Endpoints

### Authentication

- `POST /auth/request-otp` - –ó–∞–ø—Ä–æ—Å OTP –∫–æ–¥–∞
- `POST /auth/verify-otp` - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è OTP –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT
- `POST /auth/refresh` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞

### Users

- `GET /users/me` - –ü—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /users/me/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PATCH /users/me` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

### Markers

- `POST /markers` - –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∫–∏
- `GET /markers` - –°–ø–∏—Å–æ–∫ –º–µ—Ç–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- `GET /markers/{id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∫–∏
- `PATCH /markers/{id}` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∫–∏
- `DELETE /markers/{id}` - –£–¥–∞–ª–µ–Ω–∏–µ –º–µ—Ç–∫–∏
- `POST /markers/{id}/photo` - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
- `GET /markers/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–µ—Ç–æ–∫

### Moderation (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å moderator+)

- `GET /moderation/pending` - –ú–µ—Ç–∫–∏ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- `POST /moderation/{id}/approve` - –û–¥–æ–±—Ä–∏—Ç—å –º–µ—Ç–∫—É
- `POST /moderation/{id}/reject` - –û—Ç–∫–ª–æ–Ω–∏—Ç—å –º–µ—Ç–∫—É
- `POST /moderation/{id}/resolve` - –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ —Ä–µ—à–µ–Ω–æ (police)
- `GET /moderation/{id}/history` - –ò—Å—Ç–æ—Ä–∏—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- `GET /moderation/stats/me` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞

### Admin (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å admin)

- `GET /admin/users` - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /admin/users/{id}` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ ID
- `PATCH /admin/users/{id}` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DELETE /admin/users/{id}` - –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `http://localhost:8000/docs`

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=app --cov-report=html

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/test_auth.py
pytest tests/test_markers.py
pytest tests/test_moderation.py

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–∫—Ä—ã—Ç–∏—è
open htmlcov/index.html
```

## –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL
2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```sql
CREATE DATABASE narcomap;
CREATE USER narcomap WITH PASSWORD 'secure-password';
GRANT ALL PRIVILEGES ON DATABASE narcomap TO narcomap;
```

3. –û–±–Ω–æ–≤–∏—Ç–µ `.env`:

```bash
DATABASE_URL=postgresql://narcomap:secure-password@localhost:5432/narcomap
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python scripts/init_db.py`

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

### Twilio

```bash
# .env
SMS_PROVIDER=twilio
SMS_API_KEY=ACxxxxx:auth_token
```

### SMS.ru

```bash
# .env
SMS_PROVIDER=smsru
SMS_API_KEY=your-api-key
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä

```bash
# .env
SMS_PROVIDER=custom
SMS_API_KEY=your-api-key
SMS_API_URL=https://api.provider.com/send
```

–°–º. `app/adapters/sms_adapter.py` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## Production –¥–µ–ø–ª–æ–π

### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–∞–¥—ë–∂–Ω—ã–π `JWT_SECRET_KEY`
- [ ] –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ PostgreSQL
- [ ] –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä (`SMS_PROVIDER != mock`)
- [ ] **–û–¢–ö–õ–Æ–ß–ò–¢–ï** –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ OTP –∫–æ–¥–æ–≤ (—É–¥–∞–ª–∏—Ç–µ/–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤ `app/auth/otp.py`)
- [ ] –ù–∞—Å—Ç—Ä–æ–π—Ç–µ S3 –¥–ª—è –º–µ–¥–∏–∞ (`USE_S3=True`)
- [ ] –î–æ–±–∞–≤—å—Ç–µ Redis –¥–ª—è rate limiting
- [ ] –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS (`CORS_ORIGINS`)
- [ ] –í–∫–ª—é—á–∏—Ç–µ HTTPS
- [ ] –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (`/health` endpoint)
- [ ] –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (ELK, Sentry)

### Docker Production

```bash
# .env
DEBUG=False
DATABASE_URL=postgresql://...
SMS_PROVIDER=twilio
USE_S3=True

# docker-compose.yml - —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ db, redis, nginx

docker-compose up -d
```

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö worker'–æ–≤
docker-compose up --scale api=4
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º
- ‚úÖ OTP –∫–æ–¥—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º
- ‚úÖ RBAC —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ Rate limiting (60 req/min –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ Anti-spam (–ª–∏–º–∏—Ç—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–æ–∫)
- ‚úÖ –ì–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã
- ‚ö†Ô∏è OTP –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!)

## –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–°–º. —Ñ–∞–π–ª—ã:
- `API_EXAMPLES.md` - cURL –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤—Å–µ—Ö endpoints
- `INTEGRATION_GUIDE.md` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram, –º–æ–±–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, –¥–µ—Å–∫—Ç–æ–ø–æ–º

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ issues –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
